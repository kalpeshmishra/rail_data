<div id="load_interchange_reports">
<h3 align="center">Load Interchange Data </h3>
<p id="adi_station_heading" style="font-size: 16px;color:#cc3d16;"></p>

<table class="table hover table-bordered" id="load-interchange-reports">
  <thead class="thead-dark">
  	<%if @rakewise_load_interchange_data.present?%>
    	<tr style="color: #fff; background: #4B4B4D;">
    		<th style="vertical-align: middle;"></th>
    		<%@rakewise_load_interchange_data.each do |header,one_data|%>
    			<%@ic_point_count = @rakewise_load_interchange_data["received"].values[0].count%>
	    		<th style="vertical-align: middle;" colspan="<%=@ic_point_count*2%>"><%=header.capitalize%></th>
	    		<th style="vertical-align: middle;" colspan="2"></th>
	    	<%end%>
  	 	</tr>
  	 	<tr style="color: #fff; background: #4B4B4D;">
	    	<th style="vertical-align: middle;"></th>
	    	<%@rakewise_load_interchange_data["received"].values[0].each do |ic_type,data|%>
	    		<th style="vertical-align: middle;" colspan="2"><%=ic_type%></th>
	    	<%end%>
	    		<th style="vertical-align: middle;" colspan="2">R-Total</th>
    		<%@rakewise_load_interchange_data["despatch"].values[0].each do |ic_type,data|%>
	    		<th style="vertical-align: middle;" colspan="2"><%=ic_type%></th>
	    	<%end%>
	    		<th style="vertical-align: middle;" colspan="2">D-Total</th>
    	</tr>
	    <tr style="color: #fff; background: #4B4B4D;">
	    	<th style="vertical-align: middle;"></th>	
	    	<%(-1..@ic_point_count*2).each_with_index do |no,index|%>
		    	<th style="vertical-align: middle;">L</th>
		    	<th style="vertical-align: middle;">E</th>
	  		<%end%>	
	  	</tr>
	  <%else%>
	  	<h3>No Data found</h3>	
  	<%end%>
  </thead>
  <tbody>
  	<%if @rakewise_load_interchange_data.present?%>
  		<%temp_data = @rakewise_load_interchange_data%>
      <%stock=[]%>
      <%temp_data.each do |header_one,value_one|%>
       	<%temp_data[header_one].each do |header_two,value_two|%>
       		<%if header_two == "R-Total" or header_two == "D-Total"%>
       		<%else%>
            <%temp_data[header_one][header_two].each do |header_three,value_three|%>
              <%temp_data[header_one][header_two][header_three].each do |header_four,value_four|%>
                <%stock<<header_four%>
              <%end%>
            <%end%>
          <%end%>
        <%end%>
      <%end%>
      <%stock.uniq!%>
      <%stock.each do |stk|%>
        <tr>
          <td><%=stk%></td>
          <%temp_data.each do |header_one,value_one|%>
            <%value_one.each do |header_two,value_two|%>
              <%if header_two == "COVERED" or header_two == "OPEN"%>
                <%value_two.each do |k,v|%>
                  <%if v[stk] != nil%>
                    <td><%=v[stk].values[0] == {} ? "": v[stk].values[0] rescue nil%></td>
                    <td><%=v[stk].values[1] == {} ? "": v[stk].values[1] rescue nil%></td>
                  <%end%>
                <%end%>  
              <%elsif header_two == "R-Total" or header_two == "D-Total"%>
                <%value_two[stk].each do |k,v|%>
                  <td><%=v == {} ? "": v rescue nil%></td>
                <%end%>  
              <%end%>  
            <%end%>
          <%end%>  
        </tr>
      <%end%>
    <%end%>
  </tbody>  
</table>
</div>
<script>
  $(function () {
    effective_from = $("#start_date").val();
    effective_to = $("#end_date").val();
    document.getElementById("adi_station_heading").innerHTML="Period From: "+effective_from+" To: "+effective_to;
  });
</script>